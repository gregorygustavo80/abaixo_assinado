<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Abaixo-Assinado: Mais Espaços Pet-Friendly na Nossa Cidade!</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"/>
</head>
<body class="bg-gray-100 p-4">
  <!-- ... (cabeçalho e conteúdo anterior permanecem igual) ... -->

  <!-- JavaScript -->
  <script>
    // Mostrar caixa de comentário
    document.getElementById('btn-mostrar-comentario').addEventListener('click', () => {
      document.getElementById('caixa-comentario').classList.remove('hidden');
    });

    // Enviar assinatura
    document.getElementById('btn-assinar').addEventListener('click', async () => {
      const nome = document.getElementById('name').value.trim();
      const bairro = document.getElementById('neighborhood').value.trim();
      const pet = document.getElementById('pet').value.trim();

      if (!nome || !bairro || !pet) {
        alert("Por favor, preencha todos os campos!");
        return;
      }

      if (nome.length < 3 || bairro.length < 3 || pet.length < 2) {
        alert("Por favor, preencha os campos corretamente!\nNome e bairro devem ter pelo menos 3 caracteres.\nO campo pet deve ter pelo menos 2 caracteres.");
        return;
      }

      try {
        const response = await fetch('/assinar', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ nome, bairro, pet })
        });

        const data = await response.json();
        if (response.ok) {
          alert(data.mensagem);
          location.reload();
        } else {
          alert(data.erro || "Erro ao enviar assinatura");
        }
      } catch (error) {
        alert("Erro ao conectar com o servidor");
      }
    });

    // Enviar comentário
    document.getElementById('btn-comentario').addEventListener('click', async () => {
      const autor = document.getElementById('autor').value.trim();
      const comentario = document.getElementById('comentario').value.trim();

      if (!autor || !comentario) {
        alert("Por favor, preencha todos os campos!");
        return;
      }

      if (autor.length < 3 || comentario.length < 10) {
        alert("O nome deve ter pelo menos 3 caracteres e o comentário deve ter pelo menos 10 caracteres!");
        return;
      }

      try {
        const response = await fetch('/comentario', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ autor, comentario })
        });

        const data = await response.json();
        if (response.ok) {
          alert(data.mensagem);
          location.reload();
        } else {
          alert(data.erro || "Erro ao enviar comentário");
        }
      } catch (error) {
        alert("Erro ao conectar com o servidor");
      }
    });
  </script>
</body>
</html>
